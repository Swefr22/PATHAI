"""
PATHAI Jobs Database - Tirunelveli & Southern Tamil Nadu Focus
StartupTN Nellai Hackathon 2024
"""

# Sample Companies Database - TIRUNELVELI REGION FOCUSED
COMPANIES = [
    {
        "id": "c1",
        "name": "SPIC (Southern Petrochemical Industries)",
        "industry": "Manufacturing",
        "size": "Large (5000+)",
        "location": "Thoothukudi, Tamil Nadu",
        "culture": "Process-driven, Safety-focused",
        "preferred_archetypes": ["systematic_builder", "analytical_guardian"],
        "distance_from_nellai": "35 km"
    },
    {
        "id": "c2",
        "name": "Ramco Cements",
        "industry": "Manufacturing",
        "size": "Large (3000+)",
        "location": "Virudhunagar, Tamil Nadu",
        "culture": "Engineering excellence, Quality-focused",
        "preferred_archetypes": ["systematic_builder", "analytical_guardian"],
        "distance_from_nellai": "75 km"
    },
    {
        "id": "c3",
        "name": "Muthoot FinCorp",
        "industry": "Financial Services",
        "size": "Large (10000+)",
        "location": "Tirunelveli, Tamil Nadu",
        "culture": "Customer-focused, Growth-oriented",
        "preferred_archetypes": ["people_champion", "strategic_pragmatist"],
        "distance_from_nellai": "0 km (Local)"
    },
    {
        "id": "c4",
        "name": "TechNellai Solutions",
        "industry": "IT Services",
        "size": "Small (50-200)",
        "location": "Tirunelveli, Tamil Nadu",
        "culture": "Startup mindset, Fast-paced",
        "preferred_archetypes": ["creative_maverick", "systematic_builder"],
        "distance_from_nellai": "0 km (Local)"
    },
    {
        "id": "c5",
        "name": "Akshaya Patra Foundation",
        "industry": "Social Impact / NGO",
        "size": "Medium (500-1000)",
        "location": "Tirunelveli, Tamil Nadu",
        "culture": "Mission-driven, Compassionate",
        "preferred_archetypes": ["people_champion", "systematic_builder"],
        "distance_from_nellai": "0 km (Local)"
    },
    {
        "id": "c6",
        "name": "SIPCOT IT Park Tirunelveli",
        "industry": "IT/ITES",
        "size": "Multiple Companies",
        "location": "Tirunelveli SIPCOT",
        "culture": "Tech-focused, Professional",
        "preferred_archetypes": ["systematic_builder", "creative_maverick"],
        "distance_from_nellai": "12 km"
    },
    {
        "id": "c7",
        "name": "Indian Bank - Southern Region",
        "industry": "Banking",
        "size": "Large (10000+)",
        "location": "Tirunelveli & Branches",
        "culture": "Stable, Process-oriented",
        "preferred_archetypes": ["analytical_guardian", "systematic_builder"],
        "distance_from_nellai": "0 km (Multiple branches)"
    },
    {
        "id": "c8",
        "name": "Kalki Group",
        "industry": "Textiles & Retail",
        "size": "Medium (500-1000)",
        "location": "Tirunelveli, Tamil Nadu",
        "culture": "Traditional values, Modern approach",
        "preferred_archetypes": ["strategic_pragmatist", "people_champion"],
        "distance_from_nellai": "0 km (Local)"
    },
    {
        "id": "c9",
        "name": "V.O. Chidambaranar Port Trust",
        "industry": "Logistics & Port Operations",
        "size": "Large (2000+)",
        "location": "Thoothukudi, Tamil Nadu",
        "culture": "Government PSU, Systematic",
        "preferred_archetypes": ["systematic_builder", "analytical_guardian"],
        "distance_from_nellai": "35 km"
    },
    {
        "id": "c10",
        "name": "Thamirabarani Textiles",
        "industry": "Manufacturing",
        "size": "Medium (300-500)",
        "location": "Tirunelveli, Tamil Nadu",
        "culture": "Production-focused, Quality-conscious",
        "preferred_archetypes": ["systematic_builder", "people_champion"],
        "distance_from_nellai": "0 km (Local)"
    },
    {
        "id": "c11",
        "name": "Byju's - Southern TN",
        "industry": "EdTech",
        "size": "Large (15000+)",
        "location": "Remote (Southern TN coverage)",
        "culture": "Sales-driven, Goal-oriented",
        "preferred_archetypes": ["creative_maverick", "strategic_pragmatist"],
        "distance_from_nellai": "Remote"
    },
    {
        "id": "c12",
        "name": "TCS - Chennai (Relocation Support)",
        "industry": "IT Services",
        "size": "Large (10000+)",
        "location": "Chennai (Relocation package)",
        "culture": "Systematic, Process-driven",
        "preferred_archetypes": ["systematic_builder", "analytical_guardian"],
        "distance_from_nellai": "620 km (Relocation provided)"
    }
]

# Sample Job Postings Database - TIRUNELVELI REGION FOCUSED
JOBS = [
    {
        "id": "j1",
        "company_id": "c1",
        "title": "Graduate Engineer Trainee - Process",
        "department": "Operations",
        "experience": "0-1 years",
        "skills": ["Chemical Engineering", "Safety", "Process Control"],
        "salary_range": "₹3.5-4.5 LPA",
        "location": "Thoothukudi (35 km from Nellai)",
        "job_type": "Full-time",
        "description": "Join SPIC's operations team at Tuticorin plant. Work on chemical process optimization with comprehensive training in a safe, world-class manufacturing environment.",
        "preferred_archetype": "systematic_builder",
        "secondary_archetypes": ["analytical_guardian"],
        "posted_date": "2024-12-20",
        "openings": 15,
        "required_traits": ["analytical", "safety-conscious", "team-player"],
        "company_culture_fit": "Perfect for systematic thinkers who value process excellence and safety. SPIC's structured environment rewards consistency and attention to detail.",
        "local_advantage": "Daily transport from Tirunelveli provided. Housing support available."
    },
    {
        "id": "j2",
        "company_id": "c4",
        "title": "Web Developer",
        "department": "Engineering",
        "experience": "0-2 years",
        "skills": ["HTML", "CSS", "JavaScript", "React"],
        "salary_range": "₹2.8-4 LPA",
        "location": "Tirunelveli (Local)",
        "job_type": "Full-time",
        "description": "Build modern web applications for clients across India. Fast-paced startup environment in the heart of Tirunelveli with mentorship from experienced developers.",
        "preferred_archetype": "creative_maverick",
        "secondary_archetypes": ["systematic_builder"],
        "posted_date": "2024-12-24",
        "openings": 5,
        "required_traits": ["creative", "fast-learner", "problem-solver"],
        "company_culture_fit": "Ideal for creative problem-solvers who want startup energy without leaving home. Work on diverse projects while staying in Nellai.",
        "local_advantage": "Work from Tirunelveli! No relocation needed. Build your career in your hometown."
    },
    {
        "id": "j3",
        "company_id": "c2",
        "title": "Quality Control Engineer",
        "department": "Quality Assurance",
        "experience": "0-2 years",
        "skills": ["Testing", "Quality Standards", "Documentation"],
        "salary_range": "₹3-4 LPA",
        "location": "Virudhunagar (75 km from Nellai)",
        "job_type": "Full-time",
        "description": "Ensure cement quality meets international standards. Work with automated testing equipment in India's leading cement manufacturer.",
        "preferred_archetype": "analytical_guardian",
        "secondary_archetypes": ["systematic_builder"],
        "posted_date": "2024-12-22",
        "openings": 8,
        "required_traits": ["detail-oriented", "methodical", "quality-focused"],
        "company_culture_fit": "Perfect for analytical minds who love precision. Ramco values thoroughness and maintains highest quality standards in cement industry.",
        "local_advantage": "Stay in Southern TN region. Company bus service from Tirunelveli available."
    },
    {
        "id": "j4",
        "company_id": "c3",
        "title": "Relationship Manager - Gold Loans",
        "department": "Sales & Customer Service",
        "experience": "0-1 years",
        "skills": ["Communication", "Customer Service", "Sales"],
        "salary_range": "₹2.5-3.5 LPA + Incentives",
        "location": "Tirunelveli (Multiple Branches)",
        "job_type": "Full-time",
        "description": "Help families access quick credit against gold. Build customer relationships in Tirunelveli's trusted financial services company.",
        "preferred_archetype": "people_champion",
        "secondary_archetypes": ["strategic_pragmatist"],
        "posted_date": "2024-12-23",
        "openings": 12,
        "required_traits": ["empathetic", "persuasive", "trustworthy"],
        "company_culture_fit": "Great for people-oriented individuals who want to help families while building a sales career. Strong local presence in Nellai.",
        "local_advantage": "Multiple branches across Tirunelveli. Work in your own neighborhood!"
    },
    {
        "id": "j5",
        "company_id": "c5",
        "title": "Program Coordinator - Mid-Day Meal",
        "department": "Operations",
        "experience": "0 years (Fresh graduates)",
        "skills": ["Coordination", "Communication", "Social Work"],
        "salary_range": "₹2.2-3 LPA",
        "location": "Tirunelveli District",
        "job_type": "Full-time",
        "description": "Coordinate mid-day meal program reaching 50,000+ children in Tirunelveli district schools. Create direct social impact in your community.",
        "preferred_archetype": "people_champion",
        "secondary_archetypes": ["systematic_builder"],
        "posted_date": "2024-12-25",
        "openings": 6,
        "required_traits": ["compassionate", "organized", "mission-driven"],
        "company_culture_fit": "Perfect for empathetic individuals passionate about child nutrition and education. See your impact daily in local schools.",
        "local_advantage": "Serve your own community! Work across Tirunelveli district schools."
    },
    {
        "id": "j6",
        "company_id": "c6",
        "title": "Software Developer - SIPCOT",
        "department": "Engineering",
        "experience": "0-2 years",
        "skills": ["Java", "Python", "SQL"],
        "salary_range": "₹3.5-5 LPA",
        "location": "SIPCOT IT Park, Tirunelveli (12 km)",
        "job_type": "Full-time",
        "description": "Develop software solutions at Tirunelveli's growing IT hub. Professional environment with modern infrastructure.",
        "preferred_archetype": "systematic_builder",
        "secondary_archetypes": ["creative_maverick"],
        "posted_date": "2024-12-21",
        "openings": 20,
        "required_traits": ["technical", "problem-solver", "team-player"],
        "company_culture_fit": "Ideal for engineers who want IT career without leaving Southern TN. SIPCOT offers professional growth close to home.",
        "local_advantage": "Tirunelveli's premier IT park! Just 20 min from city center."
    },
    {
        "id": "j7",
        "company_id": "c7",
        "title": "Probationary Officer",
        "department": "Banking Operations",
        "experience": "0 years (Fresh graduates)",
        "skills": ["Banking Knowledge", "Customer Service", "Compliance"],
        "salary_range": "₹3.5-4.5 LPA",
        "location": "Tirunelveli & District Branches",
        "job_type": "Full-time",
        "description": "Start banking career with Indian Bank across Tirunelveli region. Structured training with clear promotion path.",
        "preferred_archetype": "analytical_guardian",
        "secondary_archetypes": ["people_champion"],
        "posted_date": "2024-12-19",
        "openings": 25,
        "required_traits": ["detail-oriented", "trustworthy", "customer-focused"],
        "company_culture_fit": "Perfect for detail-oriented individuals seeking stable career. Indian Bank has strong presence across Tirunelveli district.",
        "local_advantage": "Postings in Nellai district! Serve your local community."
    },
    {
        "id": "j8",
        "company_id": "c9",
        "title": "Port Operations Trainee",
        "department": "Logistics",
        "experience": "0-1 years",
        "skills": ["Logistics", "Documentation", "MS Office"],
        "salary_range": "₹3-4 LPA",
        "location": "Thoothukudi Port (35 km from Nellai)",
        "job_type": "Full-time",
        "description": "Join India's major port in cargo operations, documentation, and logistics coordination. Government PSU benefits.",
        "preferred_archetype": "systematic_builder",
        "secondary_archetypes": ["analytical_guardian"],
        "posted_date": "2024-12-20",
        "openings": 10,
        "required_traits": ["organized", "detail-oriented", "process-driven"],
        "company_culture_fit": "Great for systematic thinkers interested in logistics and international trade. Government job security with private sector dynamism.",
        "local_advantage": "Major employer in Southern TN! Transport from Tirunelveli available."
    },
    {
        "id": "j9",
        "company_id": "c8",
        "title": "Management Trainee - Retail",
        "department": "Retail Operations",
        "experience": "0-1 years",
        "skills": ["Customer Service", "Retail Management", "Communication"],
        "salary_range": "₹2.5-3.5 LPA",
        "location": "Tirunelveli (Multiple Stores)",
        "job_type": "Full-time",
        "description": "Learn retail management with Nellai's trusted textile brand. Hands-on training in customer service and store operations.",
        "preferred_archetype": "people_champion",
        "secondary_archetypes": ["strategic_pragmatist"],
        "posted_date": "2024-12-23",
        "openings": 8,
        "required_traits": ["people-oriented", "energetic", "sales-focused"],
        "company_culture_fit": "Ideal for customer-focused individuals who want retail career with local legacy brand. Fast-track to store management.",
        "local_advantage": "Tirunelveli's heritage brand! Work in your own city."
    },
    {
        "id": "j10",
        "company_id": "c10",
        "title": "Production Engineer",
        "department": "Manufacturing",
        "experience": "0-2 years",
        "skills": ["Production Planning", "Quality Control", "Team Coordination"],
        "salary_range": "₹2.8-4 LPA",
        "location": "Tirunelveli (Local)",
        "job_type": "Full-time",
        "description": "Manage textile production processes in Tirunelveli's manufacturing unit. Hands-on engineering role with production targets.",
        "preferred_archetype": "systematic_builder",
        "secondary_archetypes": ["people_champion"],
        "posted_date": "2024-12-21",
        "openings": 5,
        "required_traits": ["technical", "leadership", "process-oriented"],
        "company_culture_fit": "Perfect for engineers who want manufacturing experience close to home. Traditional industry with modern practices.",
        "local_advantage": "Local manufacturing! No commute, work in Tirunelveli."
    },
    {
        "id": "j11",
        "company_id": "c11",
        "title": "Business Development Associate",
        "department": "Sales",
        "experience": "0-1 years",
        "skills": ["Communication", "Sales", "Presentation"],
        "salary_range": "₹2.5-4 LPA + Incentives (up to ₹6 LPA)",
        "location": "Remote (Cover Southern TN)",
        "job_type": "Full-time",
        "description": "Sell educational products to parents across Southern Tamil Nadu. Work from home with field visits in Nellai region.",
        "preferred_archetype": "strategic_pragmatist",
        "secondary_archetypes": ["creative_maverick"],
        "posted_date": "2024-12-24",
        "openings": 15,
        "required_traits": ["persuasive", "self-motivated", "goal-oriented"],
        "company_culture_fit": "Great for ambitious sales professionals who want high earnings from home. EdTech leader with proven training.",
        "local_advantage": "Work from home! Cover Tirunelveli and nearby districts remotely."
    },
    {
        "id": "j12",
        "company_id": "c12",
        "title": "Graduate Engineer Trainee (with Relocation)",
        "department": "Engineering",
        "experience": "0-1 years",
        "skills": ["Programming", "Java", "SQL", "Problem Solving"],
        "salary_range": "₹3.5-4.5 LPA + Relocation Package",
        "location": "Chennai (Relocation assistance)",
        "job_type": "Full-time",
        "description": "Join TCS Chennai with complete relocation support from Tirunelveli. Training, accommodation help, and travel allowance provided.",
        "preferred_archetype": "systematic_builder",
        "secondary_archetypes": ["analytical_guardian"],
        "posted_date": "2024-12-22",
        "openings": 50,
        "required_traits": ["technical", "adaptable", "team-player"],
        "company_culture_fit": "For those willing to relocate for career growth. TCS provides complete support for Tirunelveli candidates moving to Chennai.",
        "local_advantage": "Relocation package for Nellai students! ₹50K relocation bonus + accommodation help."
    },
    {
        "id": "j13",
        "company_id": "c4",
        "title": "Digital Marketing Executive",
        "department": "Marketing",
        "experience": "0-2 years",
        "skills": ["Social Media", "Content Creation", "SEO", "Analytics"],
        "salary_range": "₹2.5-3.5 LPA",
        "location": "Tirunelveli (Local)",
        "job_type": "Full-time",
        "description": "Drive digital marketing campaigns for clients. Creative role in growing Tirunelveli IT company.",
        "preferred_archetype": "creative_maverick",
        "secondary_archetypes": ["strategic_pragmatist"],
        "posted_date": "2024-12-25",
        "openings": 3,
        "required_traits": ["creative", "data-driven", "storyteller"],
        "company_culture_fit": "Perfect for creative minds who want marketing career in tech without leaving Nellai. Learn from experienced digital marketers.",
        "local_advantage": "Build digital marketing career from Tirunelveli!"
    },
    {
        "id": "j14",
        "company_id": "c3",
        "title": "Credit Officer",
        "department": "Loans & Credit",
        "experience": "0-2 years",
        "skills": ["Financial Analysis", "Customer Assessment", "Documentation"],
        "salary_range": "₹2.8-3.8 LPA",
        "location": "Tirunelveli & Nearby Towns",
        "job_type": "Full-time",
        "description": "Assess loan applications and manage customer relationships. Financial services role with growth opportunities.",
        "preferred_archetype": "analytical_guardian",
        "secondary_archetypes": ["people_champion"],
        "posted_date": "2024-12-20",
        "openings": 10,
        "required_traits": ["analytical", "ethical", "decision-maker"],
        "company_culture_fit": "Ideal for analytical professionals who want finance career serving local community. Balance between analysis and people interaction.",
        "local_advantage": "Postings across Tirunelveli district. Stay close to home!"
    },
    {
        "id": "j15",
        "company_id": "c6",
        "title": "Technical Support Engineer",
        "department": "Customer Support",
        "experience": "0-1 years",
        "skills": ["Technical Knowledge", "Communication", "Problem Solving"],
        "salary_range": "₹2.5-3.5 LPA",
        "location": "SIPCOT IT Park, Tirunelveli",
        "job_type": "Full-time (Night shift allowance)",
        "description": "Provide technical support for US/UK clients. IT career with international exposure from Tirunelveli.",
        "preferred_archetype": "people_champion",
        "secondary_archetypes": ["systematic_builder"],
        "posted_date": "2024-12-23",
        "openings": 12,
        "required_traits": ["patient", "technical", "communicator"],
        "company_culture_fit": "Great for tech-savvy problem-solvers who enjoy helping people. International work experience without leaving Nellai.",
        "local_advantage": "Work for global clients from Tirunelveli! Night shift allowance extra."
    }
]


def get_company_by_id(company_id):
    """Get company details by ID"""
    for company in COMPANIES:
        if company['id'] == company_id:
            return company
    return None


def get_jobs_by_archetype(archetype, limit=10):
    """Get jobs that prefer a specific archetype"""
    matching_jobs = []
    
    for job in JOBS:
        # Calculate match score
        score = 0
        
        # Primary archetype match
        if job['preferred_archetype'] == archetype:
            score = 100
        # Secondary archetype match
        elif archetype in job.get('secondary_archetypes', []):
            score = 75
        # Partial match (culture compatibility)
        else:
            score = 30
        
        # Add company details
        company = get_company_by_id(job['company_id'])
        job_with_company = {
            **job,
            'company_name': company['name'] if company else 'Unknown',
            'company_industry': company['industry'] if company else 'Unknown',
            'company_size': company['size'] if company else 'Unknown',
            'company_culture': company['culture'] if company else 'Unknown',
            'distance_from_nellai': company.get('distance_from_nellai', 'N/A') if company else 'N/A',
            'match_score': score
        }
        
        matching_jobs.append(job_with_company)
    
    # Sort by match score, then prioritize local jobs
    matching_jobs.sort(key=lambda x: (
        -x['match_score'],  # Higher match score first
        0 if 'Tirunelveli' in x['location'] else 1,  # Local jobs first
        x['distance_from_nellai'] if x['distance_from_nellai'] != 'N/A' and x['distance_from_nellai'] != 'Remote' else 999
    ))
    
    return matching_jobs[:limit]


def get_all_jobs():
    """Get all available jobs with company details"""
    jobs_with_companies = []
    
    for job in JOBS:
        company = get_company_by_id(job['company_id'])
        job_with_company = {
            **job,
            'company_name': company['name'] if company else 'Unknown',
            'company_industry': company['industry'] if company else 'Unknown',
            'company_size': company['size'] if company else 'Unknown',
            'company_culture': company['culture'] if company else 'Unknown',
            'distance_from_nellai': company.get('distance_from_nellai', 'N/A') if company else 'N/A'
        }
        jobs_with_companies.append(job_with_company)
    
    return jobs_with_companies


def get_job_stats():
    """Get statistics about jobs in database"""
    local_jobs = sum(1 for job in JOBS if 'Tirunelveli' in job['location'])
    nearby_jobs = sum(1 for job in JOBS if 'Thoothukudi' in job['location'] or 'Virudhunagar' in job['location'])
    remote_jobs = sum(1 for job in JOBS if 'Remote' in job['location'])
    
    return {
        "total_jobs": len(JOBS),
        "total_companies": len(COMPANIES),
        "total_openings": sum(job['openings'] for job in JOBS),
        "local_jobs_nellai": local_jobs,
        "nearby_jobs": nearby_jobs,
        "remote_jobs": remote_jobs,
        "industries": list(set(company['industry'] for company in COMPANIES)),
        "locations": list(set(job['location'] for job in JOBS)),
        "avg_salary_range": "₹2.5-4 LPA",
        "region": "Tirunelveli & Southern Tamil Nadu"
    }